<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://www.gstatic.com/firebasejs/11.10.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.10.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    .btn {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
    }

    .btn-primary {
      background: #007bff;
      color: white;
    }

    .btn-danger {
      background: #dc3545;
      color: white;
    }

    .answers-grid {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 30px;
    }

    .answer-card {
      background: #f9f9f9;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
    }

    .answer-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 8px;
    }

    .answer-label {
      font-weight: bold;
      min-width: 100px;
    }

    .answer-actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    @media (min-width: 600px) {
      .answer-card {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }

      .answer-info {
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      .answer-actions {
        flex-shrink: 0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>📋 User Answers Panel</h2>
    <button class="btn btn-primary" onclick="fetchAnswers()">🔄 Load Answers</button>
    <div id="answers" class="answers-grid"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCrnuVZLIs6DiZ7exEdrez59OsktcMA-iU",
      authDomain: "dailyquiz-8149b.firebaseapp.com",
      projectId: "dailyquiz-8149b",
      storageBucket: "dailyquiz-8149b.appspot.com",
      messagingSenderId: "814257864320",
      appId: "1:814257864320:web:98e911b3ca5a643407b065"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function fetchAnswers() {
      const answersContainer = document.getElementById("answers");
      answersContainer.innerHTML = "<p>⏳ Loading...</p>";

      try {
        const snapshot = await db.collection("quiz_answers").orderBy("timestamp", "desc").get();
        if (snapshot.empty) {
          answersContainer.innerHTML = "<p>🚫 No answers found.</p>";
          return;
        }

        answersContainer.innerHTML = "";
        snapshot.forEach(doc => {
          const data = doc.data();
          const card = document.createElement("div");
          card.className = "answer-card";

          const info = document.createElement("div");
          info.className = "answer-info";
          info.innerHTML = `
            <div class="answer-row"><span class="answer-label">📅 Date:</span> ${data.date || 'N/A'}</div>
            <div class="answer-row"><span class="answer-label">👤 Name:</span> ${data.name || 'N/A'}</div>
            <div class="answer-row"><span class="answer-label">📞 Phone:</span> ${data.phone || 'N/A'}</div>
            <div class="answer-row"><span class="answer-label">📍 Address:</span> ${data.address || 'N/A'}</div>
            <div class="answer-row"><span class="answer-label">📝 Answer:</span> ${data.answer || 'N/A'}</div>
            <div class="answer-row"><span class="answer-label">✅ Correct:</span> ${data.correct ? "Yes" : "No"}</div>
          `;

          const actions = document.createElement("div");
          actions.className = "answer-actions";
          actions.innerHTML = `
            <button class="btn btn-primary" onclick="editAnswer('${doc.id}')">✏️ Edit</button>
            <button class="btn btn-danger" onclick="deleteAnswer('${doc.id}')">🗑️ Delete</button>
          `;

          card.appendChild(info);
          card.appendChild(actions);
          answersContainer.appendChild(card);
        });
      } catch (e) {
        answersContainer.innerHTML = `<p style="color:red">❌ Error: ${e.message}</p>`;
      }
    }

    function editAnswer(id) {
      alert("✏️ Edit feature coming soon. (Doc ID: " + id + ")");
    }

    async function deleteAnswer(id) {
      if (confirm("Are you sure you want to delete this answer?")) {
        try {
          await db.collection("quiz_answers").doc(id).delete();
          fetchAnswers(); // Reload after delete
        } catch (e) {
          alert("❌ Failed to delete: " + e.message);
        }
      }
    }
  </script>
</body>
</html>
